<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <style>
      .score {
        font-size: 50px;
        color: red;
      }
      .game-container {
        width: 100%;
        height: 400px;
        background-color: black;
        position: relative;
        overflow: hidden;
      }

      .character {
        width: 100px;
        height: 200px;
        background-image: url("c.png");
        background-size: cover;
        position: absolute;
        bottom: 0;
        left: 50px;
      }

      .block {
        width: 50px;
        height: 100px;
        background-image: url("e.png");
        background-size: cover;
        position: absolute;
        right: 0;
        bottom: 0;
        animation: moveBlock 10s linear infinite;
      }

      @keyframes moveBlock {
        from {
          right: 0;
        }
        to {
          right: 100%;
        }
      }
    </style>

    <title>si pemarah</title>
  </head>
  <body>
    <header>
      <div class="container">
        <center>
          <h1>Jangan sampai digigit yaa</h1>
          <div class="score" id="score">Score: 0</div>
          by.juve
        </center>

        <div class="game-container">
          <div class="character" id="character"></div>
          <div class="block" id="block"></div>
        </div>
      </div>
    </header>
    <center>
      <br />
      <div class="controls">
        <button onclick="moveLeft()">Left</button>
        <button onclick="moveRight()">Right</button>
        <button onclick="jump()">Jump</button>
      </div>
    </center>

    <script>
      const character = document.getElementById("character");
      const block = document.getElementById("block");
      const scoreElement = document.getElementById("score");
      let isJumping = false;
      let position = 0;
      let gravity = 2;
      let score = 0;
      let blockSpeed = 5; // Kecepatan awal balok
      let blockInterval;
      let gravityInterval;

      function startGame() {
        block.style.left = window.innerWidth + "px";
        position = 0;
        score = 0;
        scoreElement.textContent = "Score: " + score;
        blockSpeed = 5;
        isJumping = false;
        character.style.bottom = position + "px";

        // Mulai pergerakan balok
        blockInterval = setInterval(moveBlock, 20);

        // Mulai gravitasi
        gravityInterval = setInterval(applyGravity, 20);
      }

      function moveBlock() {
        let blockLeft = parseInt(
          window.getComputedStyle(block).getPropertyValue("left")
        );
        block.style.left = blockLeft - blockSpeed + "px";

        // Jika balok melewati batas kiri layar, reset ke posisi awal di kanan layar
        if (blockLeft <= -50) {
          block.style.left = window.innerWidth + "px";
          block.passed = false; // Reset passed flag
        }

        // Periksa tabrakan dan apakah balok sudah dilewati
        checkCollision();
      }

      function checkCollision() {
        const characterRect = character.getBoundingClientRect();
        const blockRect = block.getBoundingClientRect();

        // Periksa tabrakan antara karakter dan balok
        if (
          characterRect.right > blockRect.left &&
          characterRect.left < blockRect.right &&
          characterRect.bottom > blockRect.top &&
          characterRect.top < blockRect.bottom
        ) {
          alert("Anda digigit unaaa!!:(");
          resetGame();
        }

        // Jika balok sudah melewati karakter dan belum ditandai sebagai "passed"
        if (blockRect.right < characterRect.left && !block.passed) {
          score++;
          scoreElement.textContent = "Score: " + score;
          block.passed = true; // Tandai balok sudah dilewati
          updateBlockSpeed(); // Perbarui kecepatan balok
        }
      }

      function updateBlockSpeed() {
        // Kecepatan balok meningkat seiring bertambahnya skor
        blockSpeed = 5 + Math.floor(score / 3) * 2;
      }

      function jump() {
        if (isJumping) return;
        isJumping = true;

        let count = 0;
        let jumpInterval = setInterval(() => {
          if (count === 40) {
            clearInterval(jumpInterval);
            let downInterval = setInterval(() => {
              if (count === 0) {
                clearInterval(downInterval);
                isJumping = false;
              }
              position -= 5;
              count--;
              character.style.bottom = position + "px";
            }, 20);
          }

          position += 5;
          count++;
          character.style.bottom = position + "px";
        }, 20);
      }

      function moveLeft() {
        let left = parseInt(
          window.getComputedStyle(character).getPropertyValue("left")
        );
        if (left > 0) {
          character.style.left = left - 10 + "px";
        }
      }

      function moveRight() {
        let left = parseInt(
          window.getComputedStyle(character).getPropertyValue("left")
        );
        if (left < window.innerWidth - 60) {
          character.style.left = left + 10 + "px";
        }
      }

      function applyGravity() {
        if (!isJumping) {
          position -= gravity;
          if (position < 0) position = 0; // Stop at ground level
          character.style.bottom = position + "px";
        }
      }

      function resetGame() {
        clearInterval(blockInterval);
        clearInterval(gravityInterval);
        startGame();
      }

      // Mulai permainan
      startGame();

      document.addEventListener("keydown", function (event) {
        if (event.key === "ArrowUp") {
          jump();
        }
        if (event.key === "ArrowLeft") {
          moveLeft();
        }
        if (event.key === "ArrowRight") {
          moveRight();
        }
      });
    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
